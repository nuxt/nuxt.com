<template>
  <div ref="header" class="absolute w-full top-6 transition-colors duration-500" :class="[{'delay-100': step === 3 }, headerColor]">
    <svg viewBox="0 0 616 123" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0.0842905 11.6321L0.5 69L517.5 122.5L516.262 82.8861C516.11 78.0359 512.499 73.9945 507.696 73.3011L11.513 1.66225C5.4551 0.787606 0.0399386 5.51152 0.0842905 11.6321Z" fill="currentColor" :fill-opacity="opacity" />
      <path d="M212.85 62.7902L187.406 59.2979C185.903 59.0916 184.782 57.8067 184.782 56.2889C184.782 54.4505 186.403 53.0336 188.225 53.2788L213.677 56.7052C215.318 56.926 216.488 58.407 216.323 60.0538C216.15 61.7851 214.574 63.0268 212.85 62.7902Z" :fill="contentColor" />
      <path d="M230.911 60.9009L230.721 61.1551C230.32 61.6888 230.182 62.3745 230.344 63.0218C230.56 63.8859 231.272 64.5367 232.152 64.6736L256.41 68.4469C257.548 68.624 258.695 68.1783 259.414 67.2785L259.764 66.8416C260.334 66.1287 260.438 65.1492 260.03 64.3326C259.683 63.6387 259.015 63.1618 258.246 63.0593L233.599 59.773C232.565 59.6352 231.537 60.0665 230.911 60.9009Z" :fill="contentColor" />
      <path d="M301.101 68.5695L276.329 65.2665C275.372 65.139 274.422 65.538 273.843 66.3099C273.284 67.0545 273.154 68.0364 273.5 68.9006L273.545 69.0123C273.93 69.9752 274.803 70.6567 275.83 70.7969L299.281 73.9947C300.413 74.1491 301.543 73.6974 302.257 72.8054L302.619 72.3518C303.19 71.6389 303.294 70.6595 302.885 69.8429C302.538 69.149 301.87 68.6721 301.101 68.5695Z" :fill="contentColor" />
      <path d="M343.345 74.0798L318.573 70.7768C317.616 70.6493 316.666 71.0483 316.087 71.8202C315.528 72.5648 315.398 73.5467 315.744 74.4109L315.789 74.5225C316.174 75.4854 317.047 76.167 318.074 76.3071L341.525 79.505C342.657 79.6593 343.787 79.2077 344.501 78.3156L344.864 77.8621C345.434 77.1492 345.538 76.1697 345.129 75.3531C344.782 74.6592 344.114 74.1823 343.345 74.0798Z" :fill="contentColor" />
      <path d="M356.614 77.92L356.584 78.0102C356.343 78.7344 356.399 79.5247 356.74 80.2074C357.172 81.0709 358.008 81.6604 358.966 81.7772L380.721 84.4303C381.847 84.5676 382.965 84.1118 383.673 83.2257L384.043 82.7635C384.616 82.0482 384.72 81.0654 384.31 80.2461C383.964 79.5544 383.3 79.0773 382.534 78.9704L359.992 75.825C358.508 75.618 357.088 76.4989 356.614 77.92Z" :fill="contentColor" />
      <path d="M465.185 97.6884V86.1576C465.185 83.9493 467.119 82.2401 469.31 82.5122L493.188 85.4761C495.027 85.7044 496.408 87.2677 496.408 89.1215V100.168C496.408 102.347 494.523 104.047 492.356 103.822L468.478 101.342C466.607 101.148 465.185 99.5702 465.185 97.6884Z" :fill="contentColor" />
      <path d="M49.2605 51.3065L59.2071 52.1981C59.5358 52.1981 59.8587 52.1128 60.1434 51.9508C60.4281 51.7887 60.6644 51.5555 60.8287 51.2748C60.993 50.9941 61.0794 50.6756 61.0793 50.3515C61.0791 50.0274 60.9924 49.709 60.8279 49.4284L54.0211 36.2676C53.8568 35.9869 53.6205 35.7538 53.3359 35.5918C53.0513 35.4297 52.7284 35.3444 52.3998 35.3444C52.0712 35.3444 51.7483 35.4297 51.4637 35.5918C51.1791 35.7538 50.9428 35.9869 50.7785 36.2676L49.6679 39.1725L45.8441 32.3103C45.6797 32.0296 45.4433 31.7966 45.1586 31.6345C44.8739 31.4725 44.551 31.3872 44.2223 31.3872C43.8936 31.3872 43.5707 31.4725 43.286 31.6345C43.0014 31.7966 42.7649 32.0296 42.6005 32.3103L35.0365 47.4855C34.872 47.7661 34.7853 48.0844 34.7852 48.4086C34.785 48.7327 34.8714 49.0511 35.0357 49.3319C35.2 49.6126 35.4364 49.8457 35.721 50.0078C36.0057 50.1699 36.3286 50.2552 36.6573 50.2551L42.4183 50.7753C44.9922 50.7753 46.8903 49.6605 48.1964 47.4855L50.9599 42.1551L52.3993 39.3048L57.3534 49.3001L50.9599 48.4086L49.2605 51.3065ZM42.3124 47.8743L37.7789 47.8734L44.2253 35.3445L47.9654 42.0705L45.6951 45.949C44.8278 47.3602 43.8424 47.8743 42.3124 47.8743Z" :fill="logoColor" />
    </svg>
    <div />
  </div>
</template>

<script setup lang="ts">
import { useMotion } from '@vueuse/motion'

const props = defineProps({
  step: {
    type: Number,
    default: 0
  }
})

const header = ref(null)
const logoColor = ref('#0C0C0D')
const contentColor = ref('#D4D4D8')
const headerColor = ref('u-text-gray-300')
const opacity = ref(0.3)
const headerMotion = useMotion(header,
  {
    base: {
      x: 69
    },
    enter: {
      x: 121,
      transition: {
        duration: 500,
        delay: 500,
        onComplete: () => {
          setTimeout(() => {
            initHeader()
            headerMotion.apply('leave')
          }, 1000)
        }
      }
    },
    leave: {
      x: 69,
      transition: {
        duration: 500
      }
    }
  }
)

function initHeader () {
  headerColor.value = 'u-text-gray-300'
  logoColor.value = '#0C0C0D'
  contentColor.value = '#D4D4D8'
  opacity.value = 0.3
}

watch(() => props.step, () => {
  if (props.step === 2 || props.step === 3) {
    opacity.value = 1
    headerColor.value = 'text-green-400'
    logoColor.value = '#ffffff'
    contentColor.value = '#ffffff'
    if (props.step === 2) {
      headerMotion.set('base')
      headerMotion.apply('enter')
    } else {
      headerMotion.set('base')
    }
  } else {
    initHeader()
    headerMotion.set('base')
  }
})
</script>
